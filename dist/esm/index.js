var u=Object.defineProperty,x=Object.defineProperties,f=Object.getOwnPropertyDescriptors,g=Object.getOwnPropertySymbols,b=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable,m=(a,t,e)=>t in a?u(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,o=(a,t)=>{for(var e in t||(t={}))b.call(t,e)&&m(a,e,t[e]);if(g)for(var e of g(t))v.call(t,e)&&m(a,e,t[e]);return a},w=(a,t)=>x(a,f(t));class y{constructor(t,e){this._options={dict404:"",doAllowEscapeChar:!1,doAllowWhitespace:!1,maxChars:64,maxWhitespace:64,tags:{close:"}}",open:"{{"},validChars:"a-zA-Z0-9_-"},this._template="",this._templateMap={},this._templateModel=[],this._templateEngine=s=>{const h=o({},this._templateMap),r=[...this._templateModel];for(let i=0,c=Object.keys(s),n=c.length;i<n;i++){const l=c[i];if(h[l]!==void 0)for(let p=0,_=h[l].length;p<_;p++)r[h[l][p]]=s[l]}return"".concat(...r)},this._map=s=>{const h=this.getDict404(),r=!!this._options.doAllowEscapeChar,i=this._regexp,c={},n=[];let l=0,p=null;for(;(p=i.exec(s))!==null;){if(r&&p[0][0]==="!"){n.push(s.slice(l,p.index),s.slice(p.index+1,i.lastIndex)),l=i.lastIndex;continue}const _=p[1];c[_]||(c[_]=[]),n.push(s.slice(l,p.index),h),c[_].push(n.length-1),l=i.lastIndex}n.push(s.slice(l)),this._templateMap=o({},c),this._templateModel=[...n]},this._options=w(o(o({},this._options),t),{tags:o(o({},this._options.tags),t?.tags)}),this.setDict(e||{}),this.setDict404(this._options.dict404);const d=this._options.doAllowWhitespace?`\\s{0,${this._options.maxWhitespace}}`:"";this._regexp=new RegExp(`${this._options.doAllowEscapeChar?"!?":""}${this._options.tags.open}${d}([${this._options.validChars}]{1,${this._options.maxChars}})${d}${this._options.tags.close}`,"g"),this._engine=this._options.doAllowEscapeChar?(s,h)=>s.replace(this._regexp,(r,i)=>r[0]==="!"?r.slice(1):h[i]||this._dict404):(s,h)=>s.replace(this._regexp,(r,i)=>h[i]||this._dict404)}getDict(){return this._dict}setDict(t){this._dict=o({},t)}getDict404(){return this._dict404}setDict404(t){this._dict404=t}getTemplate(){return this._template}setTemplate(t){this._map(t),this._template=t}compile(t,e){return this._engine(t,e?o({},e):o({},this.getDict()))}template(t){return this._templateEngine(t?o({},t):o({},this.getDict()))}}export{y as default};
